<!DOCTYPE HTML>
<html lang="ja" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Railsでよく使われるコマンド - 爆速で身に着けるRuby on Rails：自分だけのCMSを開発しよう！</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="会員制メディア&amp;CMS開発による実践的アプローチ">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../welcome.html">Welcome to 爆速で身に着けるRuby on Rails：自分だけのCMSを開発しよう！</a></li><li class="chapter-item expanded "><a href="../running-the-course.html"><strong aria-hidden="true">1.</strong> 本講座について</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../running-the-course/course-structure.html"><strong aria-hidden="true">1.1.</strong> 講座</a></li><li class="chapter-item expanded "><a href="../running-the-course/course-building.html"><strong aria-hidden="true">1.2.</strong> 事前準備</a></li><li class="chapter-item expanded "><a href="../running-the-course/demo-day.html"><strong aria-hidden="true">1.3.</strong> Demo Day</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Day 0: Ruby基礎</li><li class="chapter-item expanded "><a href="../day-0/what-is-ruby.html"><strong aria-hidden="true">2.</strong> Rubyとは</a></li><li class="chapter-item expanded "><a href="../day-0/exercise/welcome.html"><strong aria-hidden="true">3.</strong> Exercise</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../day-0/exercise/exercise-janken.html"><strong aria-hidden="true">3.1.</strong> Exercise - じゃんけんプログラム</a></li><li class="chapter-item expanded "><a href="../day-0/exercise/exercise-vending-machine.html"><strong aria-hidden="true">3.2.</strong> Exercise - 自動販売機プログラム</a></li></ol></li><li class="chapter-item expanded "><a href="../day-0/appendix/welcome.html"><strong aria-hidden="true">4.</strong> Appendix</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../day-0/appendix/program.html"><strong aria-hidden="true">4.1.</strong> プログラム・文・式</a></li><li class="chapter-item expanded "><a href="../day-0/appendix/variables.html"><strong aria-hidden="true">4.2.</strong> 変数と定数</a></li><li class="chapter-item expanded "><a href="../day-0/appendix/literal.html"><strong aria-hidden="true">4.3.</strong> リテラル</a></li><li class="chapter-item expanded "><a href="../day-0/appendix/operator.html"><strong aria-hidden="true">4.4.</strong> 演算子式</a></li><li class="chapter-item expanded "><a href="../day-0/appendix/control.html"><strong aria-hidden="true">4.5.</strong> 制御構文</a></li><li class="chapter-item expanded "><a href="../day-0/appendix/call.html"><strong aria-hidden="true">4.6.</strong> メソッド呼び出し(super・ブロック付き・yield)</a></li><li class="chapter-item expanded "><a href="../day-0/appendix/def.html"><strong aria-hidden="true">4.7.</strong> クラス/メソッドの定義</a></li><li class="chapter-item expanded "><a href="../day-0/appendix/flexical.html"><strong aria-hidden="true">4.8.</strong> 字句構造</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Day 0: Ruby on Rails基礎</li><li class="chapter-item expanded "><a href="../day-0/what-is-ruby-on-rails.html"><strong aria-hidden="true">5.</strong> Ruby on Railsとは?</a></li><li class="chapter-item expanded "><a href="../day-0/how-to-setup.html"><strong aria-hidden="true">6.</strong> Ruby on Railsの環境構築</a></li><li class="chapter-item expanded "><a href="../day-0/web-development-overview.html"><strong aria-hidden="true">7.</strong> Ruby on Railsを用いたWeb開発の全体像</a></li><li class="chapter-item expanded affix "><li class="part-title">Day0: 事前学習</li><li class="chapter-item expanded "><a href="../day-0/goal.html"><strong aria-hidden="true">8.</strong> 本講義プロジェクトMyCMSのER図</a></li><li class="chapter-item expanded "><a href="../day-0/cms-sample.html"><strong aria-hidden="true">9.</strong> 記事管理機能⓪：サンプル</a></li><li class="chapter-item expanded affix "><li class="part-title">Day0 課題(Day1に向けた課題):</li><li class="chapter-item expanded "><a href="../day-0/cms-tag.html"><strong aria-hidden="true">10.</strong> 記事管理機能①：タグ管理</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../day-0/cms-tag-index.html"><strong aria-hidden="true">10.1.</strong> 一覧画面</a></li><li class="chapter-item expanded "><a href="../day-0/cms-tag-show.html"><strong aria-hidden="true">10.2.</strong> 詳細画面</a></li><li class="chapter-item expanded "><a href="../day-0/cms-tag-edit.html"><strong aria-hidden="true">10.3.</strong> 編集画面</a></li><li class="chapter-item expanded "><a href="../day-0/cms-tag-new.html"><strong aria-hidden="true">10.4.</strong> 作成画面</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">Day1 講義:</li><li class="chapter-item expanded "><a href="../day-1/lecture.html"><strong aria-hidden="true">11.</strong> Day1 講義用ページ</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../day-1/handson.html"><strong aria-hidden="true">11.1.</strong> Day1 ハンズオン</a></li></ol></li><li class="chapter-item expanded "><a href="../day-1/theme.html"><strong aria-hidden="true">12.</strong> Day2に向けた課題</a></li><li class="chapter-item expanded affix "><li class="part-title">Day2 講義:</li><li class="chapter-item expanded "><a href="../day-2/day-1-qa.html"><strong aria-hidden="true">13.</strong> Day1 QA</a></li><li class="chapter-item expanded "><a href="../day-2/lecture.html"><strong aria-hidden="true">14.</strong> Day2 講義用ページ</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../day-2/handson.html"><strong aria-hidden="true">14.1.</strong> Day2 ハンズオン</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../day-2/handson-auth-registration.html"><strong aria-hidden="true">14.1.1.</strong> 認証機能: 新規登録</a></li><li class="chapter-item expanded "><a href="../day-2/handson-auth-session.html"><strong aria-hidden="true">14.1.2.</strong> 認証機能: ログイン</a></li><li class="chapter-item expanded "><a href="../day-2/handson-payment.html"><strong aria-hidden="true">14.1.3.</strong> 決済機能</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../day-2/theme.html"><strong aria-hidden="true">15.</strong> Day3に向けた課題</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Day3 講義:</li><li class="chapter-item expanded "><a href="../day-3/welcome.html"><strong aria-hidden="true">16.</strong> Day3用ページ</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../day-3/short-url.html"><strong aria-hidden="true">16.1.</strong> Day3: 短縮URL管理画面</a></li><li class="chapter-item expanded "><a href="../day-3/short-url-tracking.html"><strong aria-hidden="true">16.2.</strong> Day3: 短縮URLトラッキング機能</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">Appendix</li><li class="chapter-item expanded "><a href="../appendix/welcome.html"><strong aria-hidden="true">17.</strong> Appendix</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../appendix/mvc-r.html"><strong aria-hidden="true">17.1.</strong> MVCとルーティング</a></li><li class="chapter-item expanded "><a href="../appendix/routing.html"><strong aria-hidden="true">17.2.</strong> ルーティングについて</a></li><li class="chapter-item expanded "><a href="../appendix/database-design.html"><strong aria-hidden="true">17.3.</strong> データベース構造と設計</a></li><li class="chapter-item expanded "><a href="../appendix/database-migration.html"><strong aria-hidden="true">17.4.</strong> マイグレーション</a></li><li class="chapter-item expanded "><a href="../appendix/active-record.html"><strong aria-hidden="true">17.5.</strong> ActiveRecordについて</a></li><li class="chapter-item expanded "><a href="../appendix/controller.html"><strong aria-hidden="true">17.6.</strong> Controllerにまつわる処理ついて</a></li><li class="chapter-item expanded "><a href="../appendix/rails-dev-command.html" class="active"><strong aria-hidden="true">17.7.</strong> Railsでよく使われるコマンド</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">爆速で身に着けるRuby on Rails：自分だけのCMSを開発しよう！</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="railsでよく使われるコマンド"><a class="header" href="#railsでよく使われるコマンド">Railsでよく使われるコマンド</a></h1>
<h2 id="binrails-generate--binrails-g"><a class="header" href="#binrails-generate--binrails-g">bin/rails generate || bin/rails g</a></h2>
<h3 id="binrails-g-migration"><a class="header" href="#binrails-g-migration">bin/rails g migration</a></h3>
<p>マイグレーションファイルを作成します。マイグレーションは、データベースの構造を変更するためのファイルです。Railsでは、マイグレーションを使ってデータベースの構造を変更します。</p>
<ul>
<li>db/migrate/にマイグレーションファイルを作成します。</li>
</ul>
<p>[command]</p>
<pre><code class="language-console">bin/rails g migration CreateTags
</code></pre>
<pre><code class="language-console">/workspace# bin/rails g migration CreateTags
      invoke  active_record
      create    db/migrate/20230708053757_create_tags.rb
</code></pre>
<p>[output]</p>
<p>コマンドを実行すると以下のファイルが作成されます。</p>
<p>Filename: db/migrate/20230708053757_create_tags.rb</p>
<pre><code class="language-ruby"># frozen_string_literal: true

class CreateTags &lt; ActiveRecord::Migration[7.0]
  def change
    create_table :tags do |t|

      t.timestamps
    end
  end
end
</code></pre>
<p>テーブルに定義したいカラムを追加します。タグ名を管理するためにnameカラムを追加したい場合は、以下のように記述します。</p>
<pre><code class="language-ruby"># frozen_string_literal: true

class CreateTags &lt; ActiveRecord::Migration[7.0]
  def change
    create_table :tags, id: :uuid do |t|
      t.string :name, null: false, comment: &quot;タグ名&quot;
      t.timestamps
    end
  end
end
</code></pre>
<p>マイグレーションしたい場合は、<code>bin/rails db:migrate</code>を実行します。</p>
<h3 id="binrails-g-model"><a class="header" href="#binrails-g-model">bin/rails g model</a></h3>
<p><code>bin/rails g model</code>は、モデルを作成するコマンドです。モデルは、データベースのテーブルと対応するクラスです。モデルを作成すると、以下のファイルが作成されます。</p>
<ul>
<li>app/models/にモデルファイルを作成します。</li>
<li>db/migrate/にマイグレーションファイルを作成します。</li>
<li>test/models/にテストファイルを作成します。</li>
<li>test/fixtures/にテストデータを作成します。</li>
</ul>
<p>[command]</p>
<pre><code class="language-console">bin/rails g model Tag
</code></pre>
<p>モデル作成時に、カラムを指定することもできます。</p>
<p>[command]</p>
<pre><code class="language-console">bin/rails g model Tag name:string
</code></pre>
<h3 id="binrails-g-controller"><a class="header" href="#binrails-g-controller">bin/rails g controller</a></h3>
<p><code>bin/rails g controller</code>は、コントローラを作成するコマンドです。コントローラは、アクションと呼ばれるメソッドを定義するクラスです。コントローラを作成すると、以下のファイルが作成されます。</p>
<ul>
<li>app/controllers/にコントローラファイルを作成します。</li>
<li>app/views/にビューファイルを作成します。</li>
<li>test/controllers/にテストファイルを作成します。</li>
<li>app/helpers/にヘルパーファイルを作成します。</li>
<li>test/fixtures/にテストデータを作成します。</li>
<li>config/routes.rbにルーティングを追加します。</li>
<li>app/assets/stylesheets/にCSSファイルを作成します。</li>
<li>app/assets/javascripts/にJavaScriptファイルを作成します。</li>
</ul>
<p>[command]</p>
<pre><code class="language-console">bin/rails g controller Tags
</code></pre>
<p>名前空間を指定することもできます。</p>
<pre><code class="language-console">bin/rails g controller Admin::Tags
</code></pre>
<h2 id="binrails-server--binrails-s"><a class="header" href="#binrails-server--binrails-s">bin/rails server || bin/rails s</a></h2>
<p>Railsの開発用サーバー(Puma)を起動します。Railsの開発中によく使うコマンドで、ブラウザからアクセスすることができます。</p>
<p>[command]</p>
<pre><code class="language-console">bin/rails server
</code></pre>
<p>短縮形である<code>bin/rails s</code>でも起動できます。</p>
<pre><code class="language-console">bin/rails s
</code></pre>
<h3 id="ポート番号を指定する"><a class="header" href="#ポート番号を指定する">ポート番号を指定する</a></h3>
<p>デフォルトでは、Railsの開発用サーバーは3000番ポートで起動します。ポート番号を変更する場合は、<code>-p</code>オプションを使います。</p>
<p>[command]</p>
<pre><code class="language-console">bin/rails server -p 3001
</code></pre>
<h3 id="ホスト名を指定する"><a class="header" href="#ホスト名を指定する">ホスト名を指定する</a></h3>
<p>デフォルトでは、Railsの開発用サーバーは<code>localhost</code>のみからのアクセスを受け付けます。ホスト名を変更する場合は、<code>-b</code>オプションを使います。</p>
<p>[command]</p>
<pre><code class="language-console">bin/rails s -b 0.0.0.0
</code></pre>
<h2 id="binrails-console--binrails-c"><a class="header" href="#binrails-console--binrails-c">bin/rails console || bin/rails c</a></h2>
<p>Railsのコンソールを起動します。開発中によく使うコマンドで、Railsのコードを実行したり、データベースの操作を行ったりすることができます。</p>
<p>[command]</p>
<pre><code class="language-console">bin/rails console
</code></pre>
<p>短縮形である<code>bin/rails c</code>でも起動できます。</p>
<pre><code class="language-console">bin/rails c
</code></pre>
<h3 id="環境ごとのコンソールを起動する"><a class="header" href="#環境ごとのコンソールを起動する">環境ごとのコンソールを起動する</a></h3>
<p>webアプリケーションの開発では、開発環境と本番環境で動作が異なることがあります。Railsでは、開発環境と本番環境で動作を変えることができます。開発環境のコンソールを起動するには、<code>-e</code>オプションを使います。</p>
<pre><code class="language-console"># 環境を指定してコンソールを起動する
bin/rails c -e production
bin/rails c -e staging
</code></pre>
<p>環境を指定しない場合は、開発環境のコンソールが起動します。</p>
<pre><code class="language-console"># 環境を指定しない場合は、開発環境のコンソールが起動する
bin/rails c

# 以下のコマンドと同じ
bin/rails c -e development
</code></pre>
<h2 id="binrails-routes"><a class="header" href="#binrails-routes">bin/rails routes</a></h2>
<p>Railsのルーティングを確認することができます。</p>
<p>以下のコマンドでは、定義されている全てのルーティングを確認することができます。</p>
<p>[command]</p>
<pre><code class="language-console">bin/rails routes
</code></pre>
<h3 id="コントローラーごとにルーティングを確認する"><a class="header" href="#コントローラーごとにルーティングを確認する">コントローラーごとにルーティングを確認する</a></h3>
<p><code>--controller</code> or　<code>-c</code>オプションをつけると、コントローラーごとにルーティングを確認することができます。</p>
<p>[command]</p>
<pre><code class="language-console">bin/rails routes --controller tags
bin/rails routes -c tags
</code></pre>
<h3 id="ルーティングの一部を確認する"><a class="header" href="#ルーティングの一部を確認する">ルーティングの一部を確認する</a></h3>
<p><code>--grep</code> or　<code>-g</code>オプションをつけると、指定した文字列を含むルーティングを確認することができます。</p>
<p>[command]</p>
<pre><code class="language-console">bin/rails routes --grep tag
bin/rails routes -g tag
</code></pre>
<p><code>grep</code>コマンドを使っても同じことができます。</p>
<pre><code class="language-console"># bin/rails routes -g tagとほとんど同じ
bin/rails routes | grep tag
</code></pre>
<h2 id="binrails-dbmigratestatus"><a class="header" href="#binrails-dbmigratestatus">bin/rails db:migrate:status</a></h2>
<p>データベースのマイグレーションの状態を確認することができます。</p>
<p>RAILS_ENVを指定しない場合は、開発環境のマイグレーションの状態が確認できます。</p>
<p>[command]</p>
<pre><code class="language-console">bin/rails db:migrate:status

# 上記のコマンドの結果は以下のコマンドと同じ
bin/rails db:migrate:status RAILS_ENV=development
</code></pre>
<p>[output]</p>
<pre><code class="language-console">database: gs_expansion_rails_sample_db

 Status   Migration ID    Migration Name
--------------------------------------------------
   up     20230521111713  Create active storage tablesactive storage
   up     20230521112655  Create users
   up     20230521113755  Create user registrations
   up     20230521113756  Create user database authentications
   up     20230521113757  Create user account lockings
   up     20230521113758  Create user account trackings
   up     20230521113759  Create user password reset requests
   up     20230522112655  Create admins
   up     20230522113755  Create admin registrations
   up     20230522113756  Create admin database authentications
   up     20230522113757  Create admin account lockings
   up     20230522113758  Create admin account trackings
   up     20230522113759  Create admin password reset requests
   up     20230529075027  Create authors
   up     20230529085435  Create current status enum
   up     20230529085530  Create categories
   up     20230529113755  Create action text tablesaction text
</code></pre>
<h3 id="環境ごとのマイグレーションの状態を確認する"><a class="header" href="#環境ごとのマイグレーションの状態を確認する">環境ごとのマイグレーションの状態を確認する</a></h3>
<p>特定の環境に対してマイグレーションのステータスを確認したい場合は、環境変数RAILS_ENVを使用して環境を設定することができます。</p>
<pre><code class="language-console">RAILS_ENV=production bin/rails db:migrate:status
bin/rails db:migrate:status RAILS_ENV=production
</code></pre>
<p>※ 前後ろどちらで実行しても実行結果は同じです。</p>
<h2 id="binrails-dbmigrate"><a class="header" href="#binrails-dbmigrate">bin/rails db:migrate</a></h2>
<p>データベースのマイグレーションを実行します。RAILS_ENVを指定しない場合は、開発環境のマイグレーションが実行されます。</p>
<p>開発環境以外で誤ってマイグレーションを実行してしまっても、その環境のマイグレーションに影響はありません(RAILS_ENVが分けられている前提)。</p>
<p>[command]</p>
<pre><code class="language-console">bin/rails db:migrate

# 上記のコマンドの結果は以下のコマンドと同じ
bin/rails db:migrate RAILS_ENV=development
</code></pre>
<h3 id="環境ごとにマイグレーションを実行する"><a class="header" href="#環境ごとにマイグレーションを実行する">環境ごとにマイグレーションを実行する</a></h3>
<p>特定の環境に対してマイグレーションを実行したい場合は、環境変数RAILS_ENVを使用して環境を設定することができます。</p>
<pre><code class="language-console">RAILS_ENV=production bin/rails db:migrate
bin/rails db:migrate RAILS_ENV=production
</code></pre>
<p>※ 前後ろどちらで実行しても実行結果は同じです。</p>
<h2 id="binrails-dbrollback"><a class="header" href="#binrails-dbrollback">bin/rails db:rollback</a></h2>
<p>データベースのマイグレーションをロールバックします。RAILS_ENVを指定しない場合は、開発環境のマイグレーションがロールバックされます。</p>
<p>ロールバックは、一つ前のマイグレーションをロールバックすることができます。</p>
<pre><code class="language-console">bin/rails db:rollback

# 上記のコマンドの結果は以下のコマンドと同じ
bin/rails db:rollback RAILS_ENV=development
</code></pre>
<h4 id="例1"><a class="header" href="#例1">例1</a></h4>
<p>例えば、以下のようなマイグレーション([status])があった場合、<code>bin/rails db:rollback</code>を実行すると、<code>20230529113755  Create action text tablesaction text</code>がロールバックされます。</p>
<p>[status]</p>
<pre><code class="language-console"> Status   Migration ID    Migration Name
--------------------------------------------------
   up     20230529085530  Create categories
   up     20230529113755  Create action text tablesaction text
</code></pre>
<p>[command]</p>
<pre><code class="language-console">bin/rails db:rollback
</code></pre>
<p>[output]</p>
<pre><code class="language-console"> Status   Migration ID    Migration Name
--------------------------------------------------
   up     20230529085530  Create categories
   down     20230529113755  Create action text tablesaction text
</code></pre>
<h4 id="例2"><a class="header" href="#例2">例2</a></h4>
<p>また以下のようなマイグレーション([status])があった場合、<code>bin/rails db:rollback</code>を実行すると、<code>20230529085530  Create categories</code>がロールバックされます。</p>
<p>[status]</p>
<pre><code class="language-console"> Status   Migration ID    Migration Name
--------------------------------------------------
   up     20230529085530  Create categories
   down     20230529113755  Create action text tablesaction text
</code></pre>
<p>[command]</p>
<pre><code class="language-console">bin/rails db:rollback
</code></pre>
<p>[output]</p>
<pre><code class="language-console"> Status   Migration ID    Migration Name
--------------------------------------------------
   down     20230529085530  Create categories
   down     20230529113755  Create action text tablesaction text
</code></pre>
<h3 id="まとめてロールバックする"><a class="header" href="#まとめてロールバックする">まとめてロールバックする</a></h3>
<p><code>bin/rails db:rollback STEP=2</code>のようにSTEPオプションを指定することで、複数のマイグレーションをまとめてロールバックすることができます。</p>
<p>[status]</p>
<pre><code class="language-console"> Status   Migration ID    Migration Name
--------------------------------------------------
   up     20230529085530  Create categories
   up     20230529113755  Create action text tablesaction text
</code></pre>
<p>[command]</p>
<pre><code class="language-console">bin/rails db:rollback STEP=2
</code></pre>
<p>[output]</p>
<pre><code class="language-console"> Status   Migration ID    Migration Name
--------------------------------------------------
   down     20230529085530  Create categories
   down     20230529113755  Create action text tablesaction text
</code></pre>
<h3 id="特定のマイグレーションのみロールバックする"><a class="header" href="#特定のマイグレーションのみロールバックする">特定のマイグレーションのみロールバックする</a></h3>
<p><code>bin/rails db:migrate:down VERSION=20230529085530</code>のようにVERSIONオプションを指定することで、特定のマイグレーションのみロールバックすることができます。</p>
<p>[status]</p>
<pre><code class="language-console"> Status   Migration ID    Migration Name
--------------------------------------------------
   up     20230529085530  Create categories
   up     20230529113755  Create action text tablesaction text
</code></pre>
<p>[command]</p>
<pre><code class="language-console">bin/rails db:migrate:down VERSION=20230529085530
</code></pre>
<p>[output]</p>
<pre><code class="language-console"> Status   Migration ID    Migration Name
--------------------------------------------------
   down     20230529085530  Create categories
   up     20230529113755  Create action text tablesaction text
</code></pre>
<h2 id="binrails-dbmigrateup"><a class="header" href="#binrails-dbmigrateup">bin/rails db:migrate:up</a></h2>
<p>データベースのマイグレーションを実行します。RAILS_ENVを指定しない場合は、開発環境のマイグレーションが実行されます。</p>
<p>ロールバックしたマイグレーションを再度実行することができます。以下のように、<code>bin/rails db:migrate:up VERSION=20230529085530</code>のようにVERSIONオプションを指定することで、特定のマイグレーションのみ実行することができます。</p>
<p>[status]</p>
<pre><code class="language-console"> Status   Migration ID    Migration Name
--------------------------------------------------
   down     20230529085530  Create categories
   up     20230529113755  Create action text tablesaction text
</code></pre>
<p>[command]</p>
<pre><code class="language-console">bin/rails db:migrate:up VERSION=20230529085530
</code></pre>
<p>[output]</p>
<pre><code class="language-console"> Status   Migration ID    Migration Name
--------------------------------------------------
   up     20230529085530  Create categories
   up     20230529113755  Create action text tablesaction text
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../appendix/controller.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../appendix/controller.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../editor.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../mermaid.min.js"></script>
        <script src="../mermaid-init.js"></script>


    </div>
    </body>
</html>
